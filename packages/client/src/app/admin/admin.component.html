<div class="admin-container">
  <h1>系统配置管理</h1>

  <div class="tabs">
    <button class="tab-btn" [class.active]="activeTab === 'faqs'" (click)="activeTab = 'faqs'; loadFaqs()">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10" />
        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3" />
        <line x1="12" y1="17" x2="12.01" y2="17" />
      </svg>
      问题管理
    </button>
    <button class="tab-btn" [class.active]="activeTab === 'modules'" (click)="activeTab = 'modules'">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <rect x="3" y="3" width="7" height="7" />
        <rect x="14" y="3" width="7" height="7" />
        <rect x="14" y="14" width="7" height="7" />
        <rect x="3" y="14" width="7" height="7" />
      </svg>
      模块管理
    </button>
    <button class="tab-btn" [class.active]="activeTab === 'tags'" (click)="activeTab = 'tags'">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z" />
        <line x1="7" y1="7" x2="7.01" y2="7" />
      </svg>
      标签管理
    </button>
    <button class="tab-btn" [class.active]="activeTab === 'versions'" (click)="activeTab = 'versions'">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="6" y1="3" x2="6" y2="15" />
        <circle cx="18" cy="6" r="3" />
        <circle cx="6" cy="18" r="3" />
        <path d="M18 9a9 9 0 0 1-9 9" />
      </svg>
      版本管理
    </button>
  </div>

  <div class="tab-content">
    @if (activeTab === 'faqs') {
      <div class="section">
        <div class="section-header">
          <h2>问题列表</h2>
          <lib-button variant="primary" (click)="createFaq()">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="12" y1="5" x2="12" y2="19" />
              <line x1="5" y1="12" x2="19" y2="12" />
            </svg>
            新建问题
          </lib-button>
        </div>
        <lib-data-table [columns]="faqColumns" [data]="faqData" [actions]="faqActions"></lib-data-table>
      </div>
    }

    @if (activeTab === 'modules') {
      <div class="section">
        <div class="section-header">
          <h2>模块列表</h2>
          <lib-button variant="primary" (click)="showAddDialog('module')">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <line x1="12" y1="5" x2="12" y2="19" />
              <line x1="5" y1="12" x2="19" y2="12" />
            </svg>
            添加模块
          </lib-button>
        </div>
        <lib-data-table [columns]="moduleColumns" [data]="moduleData" [actions]="moduleActions"></lib-data-table>
      </div>
    }

    @if (activeTab === 'tags') {
      <div class="section">
        <div class="section-header">
          <h2>标签列表</h2>
          <lib-button variant="primary" (click)="showAddDialog('tag')">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <line x1="12" y1="5" x2="12" y2="19" />
              <line x1="5" y1="12" x2="19" y2="12" />
            </svg>
            添加标签
          </lib-button>
        </div>
        <lib-data-table [columns]="tagColumns" [data]="tagData" [actions]="tagActions"></lib-data-table>
      </div>
    }

    @if (activeTab === 'versions') {
      <div class="section">
        <div class="section-header">
          <h2>版本列表</h2>
          <lib-button variant="primary" (click)="showAddDialog('version')">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <line x1="12" y1="5" x2="12" y2="19" />
              <line x1="5" y1="12" x2="19" y2="12" />
            </svg>
            添加版本
          </lib-button>
        </div>
        <lib-data-table [columns]="versionColumns" [data]="versionData" [actions]="versionActions"></lib-data-table>
      </div>
    }
  </div>

  @if (showDialog) {
    <div class="dialog-overlay" (click)="closeDialog()" (keyup.escape)="closeDialog()" tabindex="0">
      <div class="dialog-wrapper" (click)="$event.stopPropagation()" (keyup)="(null)" tabindex="-1">
        <lib-card [title]="(editingItem ? '编辑' : '添加') + dialogTitle" [hasHeader]="true">
          <ng-container ngProjectAs="[header-icon]">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" />
              <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" />
            </svg>
          </ng-container>

          <form (ngSubmit)="saveItem()">
            @if (dialogType === 'module') {
              <div class="form-group">
                <label for="module-id">模块ID</label>
                <input id="module-id" type="text" [(ngModel)]="formData.id" name="id" required [disabled]="!!editingItem" placeholder="输入模块ID" class="form-input" />
              </div>
              <div class="form-group">
                <label for="module-name">名称</label>
                <input id="module-name" type="text" [(ngModel)]="formData.name" name="name" required placeholder="输入名称" class="form-input" />
              </div>
              <div class="form-group">
                <label for="module-parent">父模块ID (可选，留空为顶级模块)</label>
                <input id="module-parent" type="text" [(ngModel)]="formData.parentId" name="parentId" placeholder="输入父模块ID" class="form-input" />
              </div>
            }

            @if (dialogType === 'tag') {
              <div class="form-group">
                <label for="tag-name">标签名称</label>
                <input id="tag-name" type="text" [(ngModel)]="formData.name" name="name" required placeholder="输入标签名称" class="form-input" />
              </div>
            }

            @if (dialogType === 'version') {
              <div class="form-group">
                <label for="version-name">版本号</label>
                <input id="version-name" type="text" [(ngModel)]="formData.name" name="name" required placeholder="例如 1.0.0" class="form-input" />
              </div>
              <div class="form-group">
                <label for="version-desc">描述</label>
                <textarea id="version-desc" [(ngModel)]="formData.description" name="description" placeholder="版本描述" class="form-input" rows="3"></textarea>
              </div>
            }

            <div class="dialog-actions">
              <lib-button variant="ghost" type="button" (click)="closeDialog()">取消</lib-button>
              <lib-button variant="primary" type="submit">保存</lib-button>
            </div>
          </form>
        </lib-card>
      </div>
    </div>
  }
</div>
